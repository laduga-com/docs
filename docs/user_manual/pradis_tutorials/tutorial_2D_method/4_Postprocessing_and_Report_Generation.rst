Методические указания по решению двумерных задач
================================================

Программный комплекс для автоматизации моделирования нестационарных процессов в механических системах и системах иной физической природы

Постпроцессор POST
------------------

Постпроцессор предназначен для:

анимации результатов моделирования в реальном и модельном масштабе времени;

построения графиков изменения выходных переменных, в том числе фазовых;

создания таблиц результатов с возможностью их последующего экспорта в табличные процессоры и непосредственно в сам постпроцессор.

Запуск постпроцессора
---------------------

Запуск постпроцессора осуществляется двойным щелчком мыши по иконке post на рабочем столе или с помощью файла
**postprocessor.exe**, находящегося в папке **DINAMA\\post\\** (рисунок 1).

.. figure:: ./media/Postprocessing_and_Report2.png
   :scale: 30%
   
Рисунок 1. Файл Postprocessor.exe

Для чтения результатов моделирования необходимо открыть DAT-файл,
содержащий результаты расчета вашей модели (File – Open) (рисунок 2).

.. figure:: ./media/Postprocessing_and_Report3.png
   :scale: 30%

Рисунок 2. Выбор DAT-файла

Если в задании на расчет указано несколько операторов выполнения
задания, то для первого оператора результаты будут храниться в файле
TEST.DAT, для последующих – соответственно TEST1.DAT, TEST2.DAT … Здесь
TEST – имя файла задания.

Для дальнейшей работы с DAT-файлом ниже приведено подробное описание
функций постпроцессора.

Описание функций постпроцессора
--------------------------------

Приведем краткое описание всех пунктов меню.

+------------------------------+-----------------------------------------------------+
| **File → Open**              | .. figure:: ./media/Postprocessing_and_Report4.png  |
|                              |                                                     |
+==============================+=====================================================+
| Позволяет выбрать и открыть  | .. figure:: ./media/Postprocessing_and_Report5.png  |
| файл результатов расчёта.    |                                                     |
+------------------------------+-----------------------------------------------------+
| **File → New diagram**       | .. figure:: ./media/Postprocessing_and_Report6.png  |
+------------------------------+-----------------------------------------------------+
|                              | .. figure:: ./media/Postprocessing_and_Report7.png  |
+------------------------------+-----------------------------------------------------+
| Открывает новое окно         |                                                     |
| диаграммы.                   |                                                     |
+------------------------------+-----------------------------------------------------+
| **File → Save**              | .. figure:: ./media/Postprocessing_and_Report8.png  |
+------------------------------+-----------------------------------------------------+
| Сохраняет табличные данные   |                                                     |
| графиков в файл.             |                                                     |
+------------------------------+-----------------------------------------------------+
| **File → Save As**           | .. figure:: ./media/Postprocessing_and_Report9.png  |
+------------------------------+-----------------------------------------------------+
| Сохраняет табличные данные   |                                                     |
| графиков в файл с указанным  |                                                     |
| именем.                      |                                                     |
+------------------------------+-----------------------------------------------------+
| **File → Exit**              | .. figure:: ./media/Postprocessing_and_Report10.png |
+------------------------------+-----------------------------------------------------+
| Осуществляет выход из        |                                                     |
| постпроцессора.              |                                                     |
+------------------------------+-----------------------------------------------------+


+------------------------------+-----------------------------------------------------+
| **Edit**                     | .. figure:: ./media/Postprocessing_and_Report11.png |
+==============================+=====================================================+
| Это меню содержит три        | .. figure:: ./media/Postprocessing_and_Report12.png |
| стандартные команды: *Cut*,  |                                                     |
| *Copy* и *Paste*.            |                                                     |
| Используются они при работе  |                                                     |
| с табличными данными         |                                                     |
| графиков. Также для этих     |                                                     |
| команд есть кнопки на панели |                                                     |
| инструментов.                |                                                     |
+------------------------------+-----------------------------------------------------+

View
-----

+------------------------+-------------------------------------------------------+
| **View**               | .. figure:: ./media/Postprocessing_and_Report13.png   |
+========================+=======================================================+
| Это меню, пункты       | .. figure:: ./media/Postprocessing_and_Report14.png   |
| которого (за           |                                                       |
| исключением Undelete   |                                                       |
| All\ ,                 | .. figure:: ./media/Postprocessing_and_Report15.png   |
| который                |                                                       |
| восстанавливает все    |                                                       |
| объекты) становятся    |                                                       |
| доступными при         |                                                       |
| выделении какого-либо  |                                                       |
| объекта в окне         |                                                       |
| просмотра. У этого     |                                                       |
| меню есть своя панель  |                                                       |
| инструментов, слева в  |                                                       |
| окне просмотра:        |                                                       |
+------------------------+-------------------------------------------------------+
| **View → Wireframe**   | .. figure:: ./media/Postprocessing_and_Report16.png   |
+------------------------+-------------------------------------------------------+
| У выделенного объекта  | .. figure:: ./media/Postprocessing_and_Report17.png   |
| отображает только      |                                                       |
| каркасное отображение. |                                                       |
+------------------------+-------------------------------------------------------+
| **View → Shading**     | .. figure:: ./media/Postprocessing_and_Report18.png   |
+------------------------+-------------------------------------------------------+
|                        | .. figure:: ./media/Postprocessing_and_Report19.png   |
+------------------------+-------------------------------------------------------+
| У выделенного объекта  |                                                       |
| отображает залитое     |                                                       |
| отображение.           |                                                       |
+------------------------+-------------------------------------------------------+
| **View → Color**       | .. figure:: ./media/Postprocessing_and_Report20.png   |
+------------------------+-------------------------------------------------------+
|                        | .. figure:: ./media/Postprocessing_and_Report21.png   |
+------------------------+-------------------------------------------------------+
| У выделенного объекта  | .. figure:: ./media/Postprocessing_and_Report22.png   |
| задает цвет.           |                                                       |
+------------------------+-------------------------------------------------------+
| **View → Material**    | .. figure:: ./media/Postprocessing_and_Report23.png   |
+------------------------+-------------------------------------------------------+
|                        | .. figure:: ./media/Postprocessing_and_Report24.png   |
+------------------------+-------------------------------------------------------+
| У выделенного объекта  |                                                       |
| определяет материал.   |                                                       |
+------------------------+-------------------------------------------------------+
| **View →               | .. figure:: ./media/Postprocessing_and_Report25.png   |
| Transparency**         | .. figure:: ./media/Postprocessing_and_Report27.png   |
+------------------------+-------------------------------------------------------+
|                        | .. figure:: ./media/Postprocessing_and_Report28.png   |
+------------------------+-------------------------------------------------------+
| У выделенного объекта  |                                                       |
| определяет             |                                                       |
| прозрачность от 0 до   |                                                       |
| 10.                    |                                                       |
+------------------------+-------------------------------------------------------+
| **View → Delete**      | .. figure:: ./media/Postprocessing_and_Report29.png   |
+------------------------+-------------------------------------------------------+
|                        | .. figure:: ./media/Postprocessing_and_Report30.png   |
+------------------------+-------------------------------------------------------+
| Удаляет выделенный     |                                                       |
| объект.                |                                                       |
+------------------------+-------------------------------------------------------+

Animation
-----------

Это меню предназначено для управления анимацией в окне просмотра. У него
есть своя панель инструментов в нижней части окна просмотра.

.. figure:: ./media/Postprocessing_and_Report31.png 

+-------------------------------+-------------------------------------------------------+
| **Animation → Start**         | .. figure:: ./media/Postprocessing_and_Report33.png   |
+===============================+=======================================================+
| Устанавливает просмотр на     |                                                       |
| начальный момент времени.     |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Back Step**     |                                                       |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report35.png   |
+-------------------------------+-------------------------------------------------------+
| Делает один шаг назад по      | .. figure:: ./media/Postprocessing_and_Report36.png   |
| времени на величину указанную |                                                       |
| в поле *Time Step* на панели  |                                                       |
| инструментов:                 |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Back**          | .. figure:: ./media/Postprocessing_and_Report38.png   |
+-------------------------------+-------------------------------------------------------+
| Запускает анимацию назад по   |                                                       |
| времени.                      |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Run**           | .. figure:: ./media/Postprocessing_and_Report40.png   |
+-------------------------------+-------------------------------------------------------+
| Запускает анимацию.           |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Forward step**  | .. figure:: ./media/Postprocessing_and_Report41.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report42.png   |
+-------------------------------+-------------------------------------------------------+
| Запускает анимацию.           | .. figure:: ./media/Postprocessing_and_Report36.png   |
|                               |                                                       |
| Делает один шаг вперёд по     |                                                       |
| времени на величину указанную |                                                       |
| в поле *Time Step* на панели  |                                                       |
| инструментов:                 |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → End**           | .. figure:: ./media/Postprocessing_and_Report43.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report44.png   |
+-------------------------------+-------------------------------------------------------+
| Устанавливает просмотр на     |                                                       |
| конечный момент времени.      |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Stop**          | .. figure:: ./media/Postprocessing_and_Report45.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report46.png   |
+-------------------------------+-------------------------------------------------------+
| Останавливает анимацию и      |                                                       |
| возвращает в начальный момент |                                                       |
| времени.                      |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Pause**         | .. figure:: ./media/Postprocessing_and_Report47.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report48.png   |
+-------------------------------+-------------------------------------------------------+
| Останавливает анимацию.       |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Animation → Refresh**       | .. figure:: ./media/Postprocessing_and_Report49.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report50.png   |
+-------------------------------+-------------------------------------------------------+
| То же самое, что и *Stop*.    | .. figure:: ./media/Postprocessing_and_Report51.png   |
| Если расчёт ещё не окончен,   |                                                       |
| загружает новые данные.       |                                                       |
|                               |                                                       |
| Так же, на панели             |                                                       |
| инструментов присутствует ещё |                                                       |
| 3 неописанных объекта.        |                                                       |
|                               |                                                       |
|                               |                                                       |
|                               |                                                       |
| Когда включено, анимация      |                                                       |
| производится по реальному     |                                                       |
| времени. Когда отключено, то  |                                                       |
| по шагам расчёта. То есть,    |                                                       |
| при включенном, аниматор      |                                                       |
| пропускает какие-то шаги, или |                                                       |
| наоборот растягивает, чтобы   |                                                       |
| синхронизировать реальное и   |                                                       |
| расчётное время. А при        |                                                       |
| выключенном, просто           |                                                       |
| показывает все расчётные шаги |                                                       |
| подряд.                       |                                                       |
|                               |                                                       |
|                               | .. figure:: ./media/Postprocessing_and_Report52.png   |
|                               |                                                       |
| Бегунок можно перемещать на   |                                                       |
| любой нужный момент времени.  |                                                       |
| Картинка анимации меняется    |                                                       |
| соответственно положению      |                                                       |
| бегунка. Так же можно задать  |                                                       |
| момент времени точно с        |                                                       |
| клавиатуры.                   |                                                       |
|                               |                                                       |
|                               | .. figure:: ./media/Postprocessing_and_Report53.png   |
|                               |                                                       |
| Этот бегунок регулирует       |                                                       |
| скорость анимации.            |                                                       |
+-------------------------------+-------------------------------------------------------+

Diagrams
---------

Это меню предназначено для работы с диаграммами. У него есть своя панель
управления в верхней части окна диаграммы.

.. figure:: ./media/Postprocessing_and_Report54.png

+---------------------------+-----------------------------------------------------------+
| **Diagrams → Text table** | .. figure:: ./media/Postprocessing_and_Report55.png       |
+===========================+===========================================================+
| Открывает окно с          | .. figure:: ./media/Postprocessing_and_Report56.png       |
| табличными данными        |                                                           |
| графиков изображённых в   |                                                           |
| окне диаграммы.           |                                                           |
+---------------------------+-----------------------------------------------------------+

.. figure:: ./media/Postprocessing_and_Report57.png

+--------------------------+------------------------------------------------------------+
| -  **Diagrams → Curve    | .. figure:: ./media/Postprocessing_and_Report58.png        |
|    selection**           |                                                            |
+==========================+============================================================+
| -  Вызывает диалоговое   | .. figure:: ./media/Postprocessing_and_Report59.png        |
|    окно.                 |                                                            |
+--------------------------+------------------------------------------------------------+

.. figure:: ./media/Postprocessing_and_Report60.png

В нём можно выбирать, какие графики показывать (*Y Group*) и какую
переменную откладывать по оси Х (*X Group*). Таким образом, существует
возможность просматривать фазовые графики.

Кнопка *Select All* выбирает все пункты в группе *Y Group*

Кнопка *Reset All* убирает галочки во всех пунктах группы *Y Group*.

+-------------------------------+-------------------------------------------------------+
| **Diagrams → Refresh**        | .. figure:: ./media/Postprocessing_and_Report61.png   |
+===============================+=======================================================+
|                               | .. figure:: ./media/Postprocessing_and_Report62.png   |
+-------------------------------+-------------------------------------------------------+
| Обновляет графики на          |                                                       |
| диаграмме. То есть            |                                                       |
| перерисовывает их с учётом    |                                                       |
| последних данных, если расчёт |                                                       |
| ещё не был окончен. Так же    |                                                       |
| этой командой можно           |                                                       |
| пользоваться, если по         |                                                       |
| каким-либо причинам           |                                                       |
| изображение на диаграмме      |                                                       |
| стало некорректным.           |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Diagrams → Screen short**   | .. figure:: ./media/Postprocessing_and_Report63.png   |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report64.png   |
+-------------------------------+-------------------------------------------------------+
| Сохраняет картинку графиков в |                                                       |
| файл.                         |                                                       |
+-------------------------------+-------------------------------------------------------+
| **Diagrams → Diagram          | .. figure:: ./media/Postprocessing_and_Report65.png   |
| Properties**                  |                                                       |
+-------------------------------+-------------------------------------------------------+
|                               | .. figure:: ./media/Postprocessing_and_Report66.png   |
+-------------------------------+-------------------------------------------------------+
| Вызывает диалоговое окно для  |                                                       |
| настройки диаграмм.           |                                                       |
+-------------------------------+-------------------------------------------------------+

.. figure:: ./media/Postprocessing_and_Report67.png

Так же на панели инструментов есть ещё один объект AutoScale:

.. figure:: ./media/Postprocessing_and_Report68.png

Когда AutoScale включено, все кривые рисуются именно в том масштабе, в
каком они существуют в реальности. Когда отключено, то кривые, у которых
не задан минимум и максимум, рисуются по-прежнему, а кривые, у которых
минимум и максимум заданы, рисуются в заданных пределах, но нормируются
от нуля.

Внизу окна диаграммы показывается, какой цвет, какую кривую рисует.

.. figure:: ./media/Postprocessing_and_Report69.png

Если графиков больше двух, то этот список можно листать, чтобы увидеть
названия всех нарисованных кривых. Нажав на названия кривой, можно
вызвать её свойства.

.. figure:: ./media/Postprocessing_and_Report70.png

Параметры *Min* и *Max* задают минимум и максимум графика по оси *Y*,
если установлена галочка справа от них. То есть позволяют масштабировать
график.

Кнопка *Color* позволяет выбирать цвет, которым рисуется график.

Так же здесь можно менять название, стиль, толщину линии. Если открыто
несколько окон с диаграммами, и в нескольких будет нарисован один
график, то при смене свойств этого графика на одной диаграмме,
автоматически будут меняться его свойства и на других диаграммах. Но
увидеть это можно, только нажав *Refresh* на панели инструментов того
окна, в котором Вы хотите увидеть эти новые свойства кривой.\ **
**

Settings
---------

.. figure:: ./media/Postprocessing_and_Report71.png

+-------------------------------+------------------------------------------------------+
| Это меню содержит всего один  | .. figure:: ./media/Postprocessing_and_Report72.png  |
| пункт *Options*. Он вызывает  |                                                      |
| диалоговое окно:              |                                                      |
+===============================+======================================================+
| Поле *Deviation Coefficient*  |                                                      |
| определяет гладкость          |                                                      |
| отрисовки элементов           |                                                      |
| поверхностей второго порядка  |                                                      |
| и выше. Например, эллипсов и  |                                                      |
| сфер. Чем меньше коэффициент, |                                                      |
| тем красивее и более гладко   |                                                      |
| рисуется объект. Пределы      |                                                      |
| изменения: от 0.0001 до 0.1.  |                                                      |
| Чем хуже качество отрисовки,  |                                                      |
| тем выше производительность.  |                                                      |
+-------------------------------+------------------------------------------------------+


.. figure:: ./media/Postprocessing_and_Report73.png

Это стандартное меню для управления окнами.

.. figure:: ./media/Postprocessing_and_Report74.png

Это меню содержит всего один пункт. Он выводит информацию о ПП.

.. figure:: ./media/Postprocessing_and_Report75.png

Это все меню, которые есть ПП.


+----------------------------------------------+------------------------------------------------------+
| Кроме всего перечисленного ПП имеет ещё одну | .. figure:: ./media/Postprocessing_and_Report76.png  |
| возможность, управление ПГО. В правой части  |                                                      |
| главного окна ПП расположено дочернее окно   |                                                      |
| *PGO List*.                                  |                                                      |
|                                              |                                                      |
| Оно позволяет выбирать какие ПГО отображать  |                                                      |
| в окне просмотра, а какие нет.               |                                                      |
|                                              |                                                      |
| Кнопка *Update View* отображает выбранные    |                                                      |
| ПГО и убирает невыбранные.                   |                                                      |
|                                              |                                                      |
| Кнопка *Select All* выбирает все ПГО.        |                                                      |
|                                              |                                                      |
| Кнопка *Reset All* убирает все ПГО.          |                                                      |
+==============================================+======================================================+

Создание видеоролика
-------------------

Создание видеороликов возможно с помощью панели инструментов Video
Record Operations. Она располагается в верхней части 3D окна:

.. figure:: ./media/Postprocessing_and_Report77.png

Команда *Start Record* позволяет начать запись фрагментов на диск. При
этом пишется все изображение, находящееся в 3D окне: 3D объекты и любые
изображения поверх окна, кроме курсора (например, подсказки).

Во время записи можно интерактивно манипулировать объектами,
поворачивать, зуммировать, выполнять анимацию. Все, что происходит в
окне, будет записано на диск, а в дальнейшем в видеоролик. Таким
образом, можно записать не только анимацию решения, но и выполнить
предварительный облет модели, с указанием наиболее интересных мест.

Для окончания записи требуется нажать на кнопку *Stop Record*.

.. figure:: ./media/Postprocessing_and_Report78.png

Конвертация изображений в видеоролик выполняется с помощью команды *Save
Record*. При этом будет создан видеоролик с частотой 10 кадров в секунду
(по умолчанию).

.. figure:: ./media/Postprocessing_and_Report79.png

**Отображение модели**

На панели есть инструменты для изменения отображения модели так, как это
удобно пользователю в данный момент.

.. figure:: ./media/Postprocessing_and_Report80.png

Команда *FitAll* размещает модель полностью внутри окна.

.. figure:: ./media/Postprocessing_and_Report81.png

Команда *Zoom Window* позволяет выделить необходимую область модели,
чтобы увеличить отображение определенной части, заключенной в эту
область

.. figure:: ./media/Postprocessing_and_Report82.png

Команда *Dynamic Zooming* позволяет динамически менять размер
отображаемой части модели

.. figure:: ./media/Postprocessing_and_Report83.png

Команды *Zoom +* и *Zoom –* приближают и отдаляют вид модели

.. figure:: ./media/Postprocessing_and_Report84.png

.. figure:: ./media/Postprocessing_and_Report85.png

Команда *Dynamic Panning* позволяет динамически перемещать модель

.. figure:: ./media/Postprocessing_and_Report86.png

Команда *Global Panning* глобально перемещает модель

.. figure:: ./media/Postprocessing_and_Report87.png

Команды *Front, Back, Top, Bottom, Left, Right, Axo* размещают модель
различными видами к пользователю

.. figure:: ./media/Postprocessing_and_Report88.png

.. figure:: ./media/Postprocessing_and_Report89.png

.. figure:: ./media/Postprocessing_and_Report90.png

.. figure:: ./media/Postprocessing_and_Report91.png

.. figure:: ./media/Postprocessing_and_Report92.png

.. figure:: ./media/Postprocessing_and_Report93.png

.. figure:: ./media/Postprocessing_and_Report94.png

Команда *Dynamic Rotation* динамически вращает модель

.. figure:: ./media/Postprocessing_and_Report95.png

Команда Reset сбрасывает все настройки отображения модели

.. figure:: ./media/Postprocessing_and_Report96.png

Команда Hidden Off и Hidden On отключает либо включает заполнение граней

.. figure:: ./media/Postprocessing_and_Report97.png

.. figure:: ./media/Postprocessing_and_Report98.png

Многовариантный анализ
-----------------------

С помощью постпроцессора можно просмотреть результаты многовариантного
анализа. А именно, графически отобразить файл истории.

.. figure:: ./media/Postprocessing_and_Report99.png

Загрузить файл истории можно с помощью команды History diagram меню
Multi. В дальнейшем с загруженной диаграммой можно производить все те же
действия, что и с обычной диаграммой: выбор графиков для просмотра,
фазовые графики, создание таблицы значений, сохранение в виде картинки и
т.д.

Возможен импорт другого файла истории для сравнения.

**ПОСТПРОЦЕССИНГ И ГЕНЕРАЦИЯ ОТЧЕТОВ**

Создание инструмента по генерации отчетов в формате Excel
---------------------------------------------------------

Общая цель разработки инструмента по генерации отчетов по результатам
моделирования в формате Excel заключалось в сокращении времени
пользователей по обработке результатов и автоматическом их экспорте в
общедоступные форматы офисных приложений, которые, в свою очередь,
поддерживаются всеми основными PDM и PLM-системами. То есть данный
инструмент позволяет подготовить конечные данные по анализу и работать с
ними уже вне среды программного комплекса PRADIS. С помощью данного
инструмента у разных специалистов появляется возможность (при наличии
заранее подготовленной модели с внешними исходными данными) проводить
автоматический анализ влияния тех или иных исходных данных без
необходимости владения навыками и знаниями работы в самом программном
комплексе PRADIS.

Для реализации данного инструмента были созданы специальные компоненты
для библиотеки «Report» - «DISPdata», «DISPExcelReport», «ExcelDiagram»
и «POSTFunction». Данные компоненты совместно компонентом «Data» (см.
таблицу 1) позволяют создавать, преобразовывать и экспортировать любые
функции вывода, а также автоматически формировать их диаграммы в формате
Excel.

Таблица 1. Состав компонентов, применяемых для генерации отчетов в
формате Excel

+---+----------------+-------------------------------------------------------+-------------------------------+
| № | Название       | Изображение                                           | Описание компонента           |
|   | компонента     | компонента                                            |                               |
+===+================+=======================================================+===============================+
| 1 | Компонент Data | .. figure:: ./media/Postprocessing_and_Report100.png  | Компонент описания данных     |
+---+----------------+-------------------------------------------------------+-------------------------------+
| 2 | Компонент      | .. figure:: ./media/Postprocessing_and_Report101.png  | Компонент настройки           |
|   | DISPdata       |                                                       | отображения диаграмм          |
+---+----------------+-------------------------------------------------------+-------------------------------+
| 3 | Компонент      | .. figure:: ./media/Postprocessing_and_Report102.png  | Компонент генератор отчета в  |
|   | D              |                                                       | Excel                         |
|   | ISPExcelReport |                                                       |                               |
+---+----------------+-------------------------------------------------------+-------------------------------+
| 4 | Компонент      | .. figure:: ./media/Postprocessing_and_Report103.png  | Компонент настройки           |
|   | ExcelDiagram   |                                                       | параметров диаграмм в Excel   |
|   |                |                                                       | (ограничение диаграммы по оси |
|   |                |                                                       | X и Y минимумы и максимумы,   |
|   |                |                                                       | название осей и т.д.)         |
+---+----------------+-------------------------------------------------------+-------------------------------+
| 5 | Компонент      | .. figure:: ./media/Postprocessing_and_Report104.png  | Компонент постобработки       |
|   | POSTFunction   |                                                       | функции                       |
+---+----------------+-------------------------------------------------------+-------------------------------+

Далее приведены описания ролей и параметров этих компонентов в процедуре
генерации отчетов в формате Excel.

Компонент DATA
--------------

Компонент DATA предназначен для математического описания глобальных
данных модели. В первую очередь, это описание констант и переменных и
элементарных алгебраических операций с ними таких как, разность, сумма,
возведение в квадрат, сумма квадратов, перевод радиан в градусы. Но
стоит отметить, что ввод данных в компоненте «Data» может вестись на
языке Python, что позволяет описывать сложные математические функции,
которые невозможно описать при помощи простейшего алгебраического
синтаксиса текстового редактора.

Пример описания функций и их алгебраических операций приведен на рисунке 3.

.. figure:: ./media/Postprocessing_and_Report105.png

Рисунок 3. Пример заполнения поля компонента DATA

Компонент DISPdata
------------------

Компонент DISPdata предназначен для настройки параметров отображения
диаграмм в постпроцессоре, таких как:

-  Название оси;

-  Выбор переменной оси;

-  Максимум/минимум границ оси;

-  Высота/ширина диаграмм.

.. figure:: ./media/Postprocessing_and_Report106.png

Рисунок 4. Пример заполнения строк заполнения компонента DISPdata

Компонент DISPExcelReport
-------------------------

Компонент DISPExcelReport служит для запуска непосредственно самой
процедуры генерации отчета в формате Excel.

В поле компонента необходимо заполнить следующие строки:

-  **Report name** – наименование отчета;

**ВАЖНО!** Для корректного выполнения генерации отчета, его наименование
должно быть написано с помощью латинского алфавита.

-  **Result_File** – результирующий файл расчетной модели;

**ВАЖНО!** Результирующий файл должен иметь расширение .DAT;

-  **File_Format** – формат выводимого отчетного документа (Excel);

-  **DISPdata object** – выбор объекта отображения диаграмм (как правило
   объектом является компонент DISPdata);

-  **Diagrams** – выбор диаграмм которые в последующем будут включены в
   отчет.

.. figure:: ./media/Postprocessing_and_Report107.png

Рисунок 5. Пример заполнения строк заполнения компонента DISPExcelReport

Компонент POSTFunction 
-----------------------

Компонент POSTFunction является функцией постобработки данных,
полученных в результате анализа.

В поле компонента необходимо заполнить следующие строки:

-  **Function** – объект функции (из ниспадающего меню необходимо
   выбрать объект функции user);

-  **Parameters –** в данной строке необходимо выбрать требуемую
   операцию для выполнения постобработки такие как, разность, сумма,
   возведение в квадрат, сумма квадратов, перевод радиан в градусы. Как
   правило, операции постобработки прописываются в компоненте DATA (см.
   пример описания компонента DATA);

-  **VariableName –** наименование переменной.

.. figure:: ./media/Postprocessing_and_Report108.png

Рисунок 6. Пример заполнения строк заполнения компонента POSTFunction

Компонент ExcelDiagram 
-----------------------

Компонент ExcelDiagram является оператором обработки диаграммы, которая
в последующем будет отражена в отчете Excel.

В поле компонента необходимо заполнить следующий строки:

-  **Description** – наименование диаграммы (возможно использование кириллицы);

-  **XCurve** – переменная для оси X;

-  **XCurveMin –** минимум для оси X;

-  **XCurveMax –** минимум для оси X;

-  **XCurveName –** наименование оси X;

-  **YCurveMin –** минимум для оси Y;

-  **YCurveMax –** минимум для оси Y;

-  **YCurveName –** наименование оси Y;

-  **Function –** в данной строке необходимо указать функции
   (POSTFunction), которые необходимо включить в диаграмму.

.. figure:: ./media/Postprocessing_and_Report109.png

| Рисунок 7. Пример заполнения строк заполнения компонента ExcelDiagram

В качестве примера генерации отчета в формате Excel приводится процедура
генерации отчета для расчетной модели кривошипно-шатунного механизма
поршневого двигателя. Схема данной расчетной модели приведена на рисунке 8.

.. figure:: ./media/Postprocessing_and_Report110.png

Рисунок 8. Расчетная модель кривошипно-шатунного механизма поршневого двигателя

После настройки всех вышеперечисленных компонентов расчетная модель по
генерации отчетов в формате Excel как на рисунке 9.

.. figure:: ./media/Postprocessing_and_Report111.png

Рисунок 9. Пример расчетной модели по генерации отчетов в Excel

При корректной настройке вышеописанной модели, после завершения
процедуры расчета происходит запуск MS Excel со сгенерированным отчетом.
В сгенерированном отчете формируются два листа:

-  **Лист Dynamic1.res**

-  **Лист Dynamic1.plot**

На листе Dynamic1.res (рисунок 10) формируется таблица со всеми
числовыми значениями, выводимых параметров расчетной модели, которые
были настроены с помощью компонентов **DISP.**

.. figure:: ./media/Postprocessing_and_Report112.png

Рисунок 10. Пример листа Dynamic1.res в сгенерированном отчете

На листе Dynamic1.plot (рисунок 11) формируются все диаграммы функций,
которые были заданы с помощью компонентов **DISP** в самой расчетной
модели, а также диаграммы функций, заданных с помощью компонентов модели
генерации отчета, таких как **POSTFunction**. Параметры настроек самих
этих диаграмм были определены при помощи компонентов **DISPData**
(непосредственно в самой модели) и **ExcelDiagram** (непосредственно при
генерации отчета).

.. figure:: ./media/Postprocessing_and_Report113.png

Рисунок 11. Пример листа Dynamic1.plot в сгенерированном отчете

.. figure:: ./media/Postprocessing_and_Report114.png

Рисунок 12. Пример диаграммы созданной с помощью компонентов
модели генерации отчета
